<div
  class="column"
  [class.collapsed]="isCollapsed"
  [class.drag-hovering]="isDragHovering"
  [attr.data-column]="status"
>
  <div
    class="column-header"
    [class.mobile-clickable]="showMobileToggle"
    (click)="showMobileToggle ? onToggleCollapse() : null"
  >
    <div class="title-with-caret">
      <mat-icon fontSet="material-icons-round" [class.expanded]="!isCollapsed" class="mobile-caret"
        >chevron_right</mat-icon
      >
      <h3>{{ title }}</h3>
    </div>
    <div class="column-header-actions">
      <span class="task-count">{{ tasks.length }}</span>
    </div>
  </div>

  <div
    class="column-content"
    cdkDropList
    [cdkDropListData]="status"
    (cdkDropListDropped)="onTaskDrop($event)"
    (cdkDropListEntered)="onDragOver($event)"
    (cdkDropListExited)="onDragLeave()"
  >
    @for (task of tasks; track trackByTaskId(task.id!, task)) {
    <app-task-card
      [id]="task.id"
      [task]="task"
      [isNew]="isNewTask(task)"
      cdkDrag
      [cdkDragDisabled]="!isDragEnabledForTask(task)"
      (cdkDragStarted)="onDragStart()"
      (cdkDragEnded)="onDragEnd()"
      (cdkDragMoved)="onDragMoved($event)"
      (taskEdit)="onTaskEdit($event)"
      (taskDelete)="onTaskDelete()"
      (taskView)="onTaskView($event)"
      (dragEnabledChange)="onTaskDragEnabledChange(task.id!, $event)"
    >
    </app-task-card>
    } @if (tasks.length === 0) {
    <div class="empty-state">
      <p>No tasks yet</p>
    </div>
    }
  </div>
</div>
